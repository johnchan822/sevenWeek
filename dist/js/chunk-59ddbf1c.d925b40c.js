(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59ddbf1c"],{"99af":function(t,e,a){"use strict";var c=a("23e7"),n=a("d039"),o=a("e8b5"),s=a("861d"),l=a("7b0b"),r=a("50c4"),i=a("8418"),u=a("65f0"),d=a("1dde"),h=a("b622"),b=a("2d00"),p=h("isConcatSpreadable"),j=9007199254740991,m="Maximum allowed index exceeded",O=b>=51||!n((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),f=d("concat"),g=function(t){if(!s(t))return!1;var e=t[p];return void 0!==e?!!e:o(t)},v=!O||!f;c({target:"Array",proto:!0,forced:v},{concat:function(t){var e,a,c,n,o,s=l(this),d=u(s,0),h=0;for(e=-1,c=arguments.length;e<c;e++)if(o=-1===e?s:arguments[e],g(o)){if(n=r(o.length),h+n>j)throw TypeError(m);for(a=0;a<n;a++,h++)a in o&&i(d,h,o[a])}else{if(h>=j)throw TypeError(m);i(d,h++,o)}return d.length=h,d}})},b0c0:function(t,e,a){var c=a("83ab"),n=a("9bf2").f,o=Function.prototype,s=o.toString,l=/^\s*function ([^ (]*)/,r="name";c&&!(r in o)&&n(o,r,{configurable:!0,get:function(){try{return s.call(this).match(l)[1]}catch(t){return""}}})},f70e:function(t,e,a){"use strict";a.r(e);a("b0c0");var c=a("7a23"),n={class:"container"},o={class:"text-end"},s={class:"table align-middle"},l=Object(c["h"])("thead",null,[Object(c["h"])("tr",null,[Object(c["h"])("th"),Object(c["h"])("th",null,"品名"),Object(c["h"])("th",{style:{width:"150px"}},"數量/單位"),Object(c["h"])("th",null,"單價")])],-1),r=Object(c["h"])("i",{class:"fas fa-spinner fa-pulse"},null,-1),i=Object(c["g"])(" x "),u={key:0,class:"text-success"},d={class:"input-group input-group-sm"},h={class:"input-group mb-3"},b=Object(c["h"])("span",{class:"input-group-text",id:"basic-addon2"},null,-1),p={class:"text-end"},j={key:0,class:"text-success"},m=Object(c["h"])("td",{colspan:"3",class:"text-end"},"總計",-1),O={class:"text-end"},f={key:0},g=Object(c["h"])("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),v={class:"text-end text-success"},y=Object(c["h"])("tr",null,[Object(c["h"])("div",{class:"input-group mb-3 input-group-sm"})],-1),x={class:"input-group mb-3 input-group-sm"},C={class:"input-group-append"},k={key:1,class:"d-flex justify-content-center m-5"},D={class:"my-5 row justify-content-center"},V={class:"mb-3"},L=Object(c["h"])("label",{for:"name"},"姓名",-1),$={class:"mb-3"},w=Object(c["h"])("label",{for:"email"},"信箱",-1),S={class:"mb-3"},_=Object(c["h"])("label",{for:"phone"},"收件人電話",-1),M={class:"mb-3"},q=Object(c["h"])("label",{for:"address"},"收件人地址",-1),A={class:"mb-3"},U=Object(c["h"])("label",{for:"message",class:"form-label"},"留言",-1),F=Object(c["h"])("button",{class:"btn btn-danger",type:"sumbit"},"送出表單",-1);function E(t,e,a,E,H,J){var T=Object(c["A"])("Loading"),I=Object(c["A"])("Field"),z=Object(c["A"])("error-message"),B=Object(c["A"])("Form");return Object(c["t"])(),Object(c["e"])(c["a"],null,[Object(c["h"])("div",n,[Object(c["h"])(T,{active:H.isLoading},null,8,["active"]),""!=H.carts.carts?(Object(c["t"])(),Object(c["e"])(c["a"],{key:0},[Object(c["h"])("div",o,[Object(c["h"])("button",{class:"btn btn-outline-danger",type:"button",onClick:e[1]||(e[1]=function(){return J.delAllCartData&&J.delAllCartData.apply(J,arguments)})},"清空購物車")]),Object(c["h"])("table",s,[l,Object(c["h"])("tbody",null,[H.carts.carts?(Object(c["t"])(!0),Object(c["e"])(c["a"],{key:0},Object(c["y"])(H.carts.carts,(function(t,e){return Object(c["t"])(),Object(c["e"])("tr",{key:t+e},[Object(c["h"])("td",null,[Object(c["h"])("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(e){return J.delCartData(t)}},[r,i],8,["onClick"])]),Object(c["h"])("td",null,[Object(c["g"])(Object(c["D"])(t.product.title),1),t.coupon?(Object(c["t"])(),Object(c["e"])("div",u,"已套用優惠券")):Object(c["f"])("",!0)]),Object(c["h"])("td",null,[Object(c["h"])("div",d,[Object(c["h"])("div",h,[Object(c["M"])(Object(c["h"])("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":function(e){return t.qty=e},onChange:function(e){return J.updateCartData(t)}},null,40,["onUpdate:modelValue","onChange"]),[[c["H"],t.qty,void 0,{number:!0}]]),b])])]),Object(c["h"])("td",p,[Object(c["h"])("div",null,"原價 ："+Object(c["D"])(t.total)+"元",1),t.final_total!==t.total?(Object(c["t"])(),Object(c["e"])("div",j,"折扣價："+Object(c["D"])(t.final_total)+" 元",1)):Object(c["f"])("",!0)])])})),128)):Object(c["f"])("",!0)]),Object(c["h"])("tfoot",null,[Object(c["h"])("tr",null,[m,Object(c["h"])("td",O,Object(c["D"])(H.carts.total)+"元",1)]),H.carts.final_total!==H.carts.total?(Object(c["t"])(),Object(c["e"])("tr",f,[g,Object(c["h"])("td",v,Object(c["D"])(H.carts.final_total)+" 元",1)])):Object(c["f"])("",!0),y])]),Object(c["h"])("div",x,[Object(c["M"])(Object(c["h"])("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=function(t){return H.coupon_code=t}),placeholder:"請輸入優惠碼"},null,512),[[c["H"],H.coupon_code]]),Object(c["h"])("div",C,[Object(c["h"])("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[3]||(e[3]=function(){return J.addCouponCode&&J.addCouponCode.apply(J,arguments)})}," 套用優惠碼 ")])])],64)):(Object(c["t"])(),Object(c["e"])("h5",k,' 麻煩回到產品頁面 "點選商品" '))]),Object(c["h"])("div",D,[Object(c["h"])(B,{onSubmit:J.onSubmit,class:"col-md-6",ref:"form"},{default:Object(c["L"])((function(t){var a=t.errors;return[Object(c["h"])("div",V,[L,Object(c["h"])(I,{id:"name",name:"姓名",type:"text",class:["form-control",{"is-invalid":a["姓名"]}],placeholder:"請輸入 姓名",rules:"required",modelValue:H.user.name,"onUpdate:modelValue":e[4]||(e[4]=function(t){return H.user.name=t})},null,8,["class","modelValue"]),Object(c["h"])(z,{name:"姓名",class:"invalid-feedback"})]),Object(c["h"])("div",$,[w,Object(c["h"])(I,{id:"email",name:"email",type:"email",class:["form-control",{"is-invalid":a["email"]}],placeholder:"請輸入 Email",rules:"email|required",modelValue:H.user.email,"onUpdate:modelValue":e[5]||(e[5]=function(t){return H.user.email=t})},null,8,["class","modelValue"]),Object(c["h"])(z,{name:"email",class:"invalid-feedback"})]),Object(c["h"])("div",S,[_,Object(c["h"])(I,{id:"phone",name:"電話",type:"tel",class:["form-control",{"is-invalid":a["電話"]}],placeholder:"請輸入 電話",rules:"required|min:8",modelValue:H.user.phone,"onUpdate:modelValue":e[6]||(e[6]=function(t){return H.user.phone=t})},null,8,["class","modelValue"]),Object(c["h"])(z,{name:"電話",class:"invalid-feedback"})]),Object(c["h"])("div",M,[q,Object(c["h"])(I,{id:"address",name:"地址",type:"text",class:["form-control",{"is-invalid":a["地址"]}],placeholder:"請輸入 地址",rules:"required",modelValue:H.user.address,"onUpdate:modelValue":e[7]||(e[7]=function(t){return H.user.address=t})},null,8,["class","modelValue"]),Object(c["h"])(z,{name:"地址",class:"invalid-feedback"})]),Object(c["h"])("div",A,[U,Object(c["M"])(Object(c["h"])("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[8]||(e[8]=function(t){return H.user.message=t})},null,512),[[c["H"],H.user.message]])]),F]})),_:1},8,["onSubmit"])])],64)}a("99af");var H={data:function(){return{carts:{},cart:{},user:{email:"",name:"",phone:"",address:"",message:""},isLoading:!1,coupon_code:""}},methods:{getCartData:function(){var t=this;this.isLoading=!0;var e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("johnhexschool","/cart");this.$http.get(e).then((function(e){console.log(e),t.carts=e.data.data,t.isLoading=!1}))},delCartData:function(t){var e=this;this.isLoading=!0;var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("johnhexschool","/cart/").concat(t.id);this.$http.delete(a).then((function(t){console.log(t),e.getCartData(),e.$httpMessageState(t,"訂單刪除"),e.isLoading=!1}))},delAllCartData:function(){var t=this;this.isLoading=!0;var e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("johnhexschool","/carts");this.$http.delete(e).then((function(e){console.log(e),t.getCartData(),t.$httpMessageState(e,"全部訂單刪除"),t.isLoading=!1}))},updateCartData:function(t){var e=this;this.isLoading=!0;var a={product_id:t.id,qty:t.qty},c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("johnhexschool","/cart/").concat(t.id);this.$http.put(c,{data:a}).then((function(t){e.$httpMessageState(t,"更新數量"),console.log(t),e.getCartData(),e.isLoading=!1}))},addCouponCode:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("johnhexschool","/coupon");this.$http.post(e,{data:{code:this.coupon_code}}).then((function(e){t.$httpMessageState(e,"使用優惠劵"),console.log(e),t.getCartData()}))},onSubmit:function(){var t=this;this.isLoading=!0;var e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("johnhexschool","/order");this.$http.post(e,{data:{user:{name:this.user.name,email:this.user.email,tel:this.user.phone,address:this.user.address},message:this.user.message}}).then((function(e){t.$router.push("/checkout/".concat(e.data.orderId)),t.$httpMessageState(e,"訂單建立"),t.$refs.form.resetForm(),t.isLoading=!1}))}},created:function(){this.getCartData()}};H.render=E;e["default"]=H}}]);
//# sourceMappingURL=chunk-59ddbf1c.d925b40c.js.map